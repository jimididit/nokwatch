{% extends "base.html" %}

{% block content %}
<div id="app">
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="header-title">Website Monitor</h1>
            <div class="header-actions">
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span id="status-text">Running</span>
                </div>
                <button class="btn btn-secondary" id="test-email-btn" aria-label="Test email">
                    ‚úâÔ∏è Test Email
                </button>
                <button class="btn btn-primary" id="add-job-btn" aria-label="Add new monitor">
                    <span>+</span> Add Monitor
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Loading State -->
        <div id="loading-state" class="text-center mt-lg">
            <div class="loading"></div>
            <p class="text-muted mt-md">Loading monitors...</p>
        </div>

        <!-- Empty State -->
        <div id="empty-state" class="empty-state hidden">
            <div class="empty-state-icon">üîç</div>
            <h2 class="empty-state-title">No monitors yet</h2>
            <p class="text-secondary">Get started by adding your first website monitor</p>
            <button class="btn btn-primary mt-lg" onclick="openJobModal()">
                Create Your First Monitor
            </button>
        </div>

        <!-- Jobs Grid -->
        <div id="jobs-container" class="cards-grid hidden"></div>
    </main>

    <!-- Floating Action Button (Mobile) -->
    <button class="fab" id="fab-btn" aria-label="Add new monitor" onclick="openJobModal()">
        +
    </button>

    <!-- Job Modal -->
    <div id="job-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Add Monitor</h2>
                <button class="modal-close" onclick="closeJobModal()" aria-label="Close">√ó</button>
            </div>
            <form id="job-form" class="modal-body">
                <input type="hidden" id="job-id" name="id">
                
                <div class="form-group">
                    <label for="job-name" class="form-label">Job Name *</label>
                    <input type="text" id="job-name" name="name" class="form-input" required 
                           placeholder="e.g., HUD Waitlist Monitor" autocomplete="off">
                    <span class="form-error" id="name-error"></span>
                </div>

                <div class="form-group">
                    <label for="job-url" class="form-label">URL *</label>
                    <input type="url" id="job-url" name="url" class="form-input" required 
                           placeholder="https://example.com" autocomplete="url">
                    <span class="form-error" id="url-error"></span>
                </div>

                <div class="form-group">
                    <label for="check-interval" class="form-label">Check Interval *</label>
                    <select id="check-interval" name="check_interval" class="form-select" required>
                        <option value="30">30 seconds</option>
                        <option value="60">1 minute</option>
                        <option value="300" selected>5 minutes</option>
                        <option value="900">15 minutes</option>
                        <option value="1800">30 minutes</option>
                        <option value="3600">1 hour</option>
                    </select>
                    <span class="form-help">How often to check this website</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Match Type *</label>
                    <div class="toggle-group">
                        <button type="button" class="toggle-option active" data-value="string" onclick="toggleMatchType(this)">
                            String
                        </button>
                        <button type="button" class="toggle-option" data-value="regex" onclick="toggleMatchType(this)">
                            Regex
                        </button>
                    </div>
                    <input type="hidden" id="match-type" name="match_type" value="string">
                    <span class="form-help" id="match-type-help">Search for exact text or use regular expressions</span>
                </div>

                <div class="form-group">
                    <label for="match-pattern" class="form-label">Pattern to Match *</label>
                    <input type="text" id="match-pattern" name="match_pattern" class="form-input" required 
                           placeholder="e.g., Waitlist Open" autocomplete="off">
                    <span class="form-error" id="pattern-error"></span>
                    <span class="form-help" id="pattern-help">Text or regex pattern to search for</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Match Condition *</label>
                    <div class="toggle-group">
                        <button type="button" class="toggle-option active" data-value="contains" onclick="toggleCondition(this)">
                            Contains
                        </button>
                        <button type="button" class="toggle-option" data-value="not_contains" onclick="toggleCondition(this)">
                            Does Not Contain
                        </button>
                    </div>
                    <input type="hidden" id="match-condition" name="match_condition" value="contains">
                </div>

                <div class="form-group">
                    <label for="email-recipient" class="form-label">Email Recipient *</label>
                    <input type="email" id="email-recipient" name="email_recipient" class="form-input" required 
                           placeholder="your-email@example.com" autocomplete="email">
                    <span class="form-error" id="email-error"></span>
                    <span class="form-help">Email address to receive notifications</span>
                </div>
            </form>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeJobModal()">Cancel</button>
                <button type="submit" form="job-form" class="btn btn-primary" id="save-job-btn">Save</button>
            </div>
        </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>
</div>
{% endblock %}
